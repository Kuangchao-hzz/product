webpackJsonp([21],{1860:function(e,t,o){function a(e){o(2081)}var l=o(108)(o(2021),o(2131),a,null,null);e.exports=l.exports},2021:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(125),l=o.n(a),r=o(387);t.default={data:function(){return{loading:!1,dialogTitle:"新增用户",roleDialogIsShow:!1,tableData:[],roleList:{type:!1,name:"",routerAuth:[],checkedValue:[]},roleId:"",defaultCheckedData:[],defaultProps:{children:"children",label:"label"},rules:{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],checkedValue:[{type:"array",required:!0,message:"请选择操作权限",trigger:"change"}]},routerAuths:[]}},computed:{syncDefaultCheckedData:function(){return this.defaultCheckedData.map(function(e){return parseInt(e)})},tabHeight:function(){return this.$store.state.include.tableHeight-250}},mounted:function(){this.data_table()},methods:{getAllCheckedNodes:function(e){var t=this;e.forEach(function(e,o){t.routerAuths.push(e),e.children&&e.children.length>0&&t.getAllCheckedNodes(e.children)})},setAllCheckedNodes:function(){var e=this;this.getAllCheckedNodes(this.roleList.routerAuth),this.$nextTick(function(){e.$refs.tree.setCheckedNodes(e.routerAuths)})},resetCheckedNodes:function(){this.$refs.tree.setCheckedKeys([])},btn_auth:function(e){return this.$store.state.user.AUTHIDS.split(",").some(function(t){return t===e})},handleClose:function(e){var t=this;this.roleDialogIsShow=!1,this.roleList.routerAuth=[],this.roleList.name="",this.$refs.roleList.resetFields(),this.$nextTick(function(){t.$refs.tree.setCheckedKeys([])})},data_table:function(){var e=this;e.loading=!0,r.a.data_roleTable().then(function(t){e.loading=!1,1===t.data.code&&(e.tableData=t.data.dat)})},get_roleData:function(e){var t=this;t.roleDialogIsShow=!0,t.treeType="0",t.$nextTick(function(){e.id?(t.dialogTitle="编辑角色",t.defaultCheckedData=e.authIds.split(","),t.roleList.name=e.roleName,t.treeType=e.id):(t.dialogTitle="新增角色",t.$refs.tree.setCheckedKeys([])),r.a.data_systemRoleDate().then(function(e){1===e.data.code&&(t.roleList.routerAuth=e.data.dat)})})},edit_roleData:function(){var e=this;new l.a(function(t){e.roleList.checkedValue=e.$refs.tree.getCheckedNodes(),t()}).then(function(t){e.$refs.roleList.validate(function(t){if(!t)return!1;var o=e.$refs.tree.getCheckedNodes(),a=[];o.forEach(function(e,t){a.push(e.id)}),r.a.data_systemRoleSave({id:e.treeType,roleName:e.roleList.name,authIds:a.join(",")}).then(function(t){1===t.data.code&&(e.$message({duration:1500,message:"保存成功！"}),e.handleClose(),e.data_table())})})})},del_roleData:function(e){var t=this;swal({title:"你确定要删除该角色?",type:"warning",showCancelButton:!0,reverseButtons:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){r.a.data_systemRoleDel({roleId:e}).then(function(e){1===e.data.code&&(t.data_table(),t.$message({duration:1500,message:"删除成功！"}))})},function(){})}},watch:{roleDialogIsShow:function(){this.roleDialogIsShow}}}},2043:function(e,t,o){t=e.exports=o(1830)(!0),t.push([e.i,".view-role .role-group{margin-bottom:20px}.view-role .el-tree{height:400px;overflow-y:auto;border:1px solid #ddd;border-radius:4px}","",{version:3,sources:["D:/www.github.com/product/product/src/components/manage-system/childrens/role.vue"],names:[],mappings:"AACA,uBACE,kBAAoB,CACrB,AACD,oBACE,aAAc,AACd,gBAAiB,AACjB,sBAAuB,AACvB,iBAAmB,CACpB",file:"role.vue",sourcesContent:["\n.view-role .role-group {\n  margin-bottom: 20px;\n}\n.view-role .el-tree {\n  height: 400px;\n  overflow-y: auto;\n  border: 1px #ddd solid;\n  border-radius: 4px;\n}\n"],sourceRoot:""}])},2081:function(e,t,o){var a=o(2043);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);o(1831)("a4ddb93e",a,!0)},2131:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"view-role"},[o("div",{staticClass:"role-group"},[o("el-button",{attrs:{disabled:!e.btn_auth("b_jz_xzyh")},on:{click:e.get_roleData}},[e._v("新增角色")])],1),e._v(" "),o("div",{staticClass:"system-role-table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.loading,expression:"loading",modifiers:{body:!0}}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:e.tabHeight,"max-height":e.tabHeight,border:"","tooltip-effect":"dark"}},[o("el-table-column",{attrs:{prop:"roleName",align:"center",label:"角色"}}),e._v(" "),o("el-table-column",{attrs:{prop:"authNames",align:"center",label:"操作权限"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){e.get_roleData(t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){e.del_roleData(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),o("el-dialog",{attrs:{title:e.dialogTitle,visible:e.roleDialogIsShow,size:"small","before-close":e.handleClose},on:{"update:visible":function(t){e.roleDialogIsShow=t}}},[o("el-form",{ref:"roleList",attrs:{model:e.roleList,rules:e.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"角色名称: ",prop:"name"}},[o("el-input",{model:{value:e.roleList.name,callback:function(t){e.roleList.name=t},expression:"roleList.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"操作权限: ",prop:"checkedValue"}},[o("el-tree",{ref:"tree",attrs:{data:e.roleList.routerAuth,"show-checkbox":"","node-key":"id","check-strictly":"","default-checked-keys":e.syncDefaultCheckedData,"default-expanded-keys":e.syncDefaultCheckedData,props:e.defaultProps}})],1),e._v(" "),o("el-form-item",[o("el-button",{on:{click:e.resetCheckedNodes}},[e._v("重置")]),e._v(" "),o("el-button",{on:{click:e.setAllCheckedNodes}},[e._v("全选")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.edit_roleData}},[e._v("确定")]),e._v(" "),o("el-button",{on:{click:e.handleClose}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=21.2d6b166e66cc7d57e02b.js.map