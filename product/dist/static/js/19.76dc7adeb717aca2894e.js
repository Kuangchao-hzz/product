webpackJsonp([19],{1862:function(e,t,r){function a(e){r(2078)}var o=r(107)(r(2023),r(2128),a,null,null);e.exports=o.exports},2023:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(124),o=r.n(a),s=r(386);t.default={data:function(){return{dialogTitle:"新增用户",employeeIdDisabled:!1,tableData:[],roleList:[],defaultCheckedKeys:[],addUserForm:{id:"",employeeId:"",realName:"",phone:"",remark:"",areaIds:[],roleIds:[],addUserIsShow:!1,treeDialog:{type:!1,name:"",routerAuth:[],checkedValue:[]}},defaultProps:{children:"children",label:"label"},countryText:[],rules:{employeeId:[{required:!0,message:"请输入工号",trigger:"blur"}],realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系方式",trigger:"blur"}],remark:[{required:!0,message:"请输入备注",trigger:"blur"}],roleIds:[{type:"array",required:!0,message:"请选择角色",trigger:"blur"}],"treeDialog.checkedValue":[{type:"array",required:!0,message:"请选择区域",trigger:"change"}]}}},computed:{treeCountry:function(){return this.addUserForm.treeDialog.routerAuth},handlerCountryText:function(){return this.countryText.join("/")},defaultCheckedData:function(){return this.defaultCheckedKeys},tabHeight:function(){return this.$store.state.include.tableHeight-255},currentUserNo:function(){return localStorage.getItem("ms_username")}},mounted:function(){this.data_table(),this.data_systemUserRoleList()},methods:{btn_auth:function(e){return this.$store.state.user.AUTHIDS.split(",").some(function(t){return t===e})},handleClose:function(e){this.addUserForm.id="",this.addUserForm.employeeId="",this.addUserForm.realName="",this.addUserForm.phone="",this.addUserForm.remark="",this.addUserForm.roleIds=[],this.addUserForm.addUserIsShow=!1,this.$refs.addUserForm.resetFields(),this.addUserForm.treeDialog={type:!1,name:"",routerAuth:this.$store.state.select.treeCountry},this.$refs.tree.setCheckedKeys([])},submitForm:function(){var e=this;this.$refs.tree.getCheckedNodes().forEach(function(t,r){e.addUserForm.area.push(t.id)})},data_table:function(){var e=this;s.a.data_systemUserAll().then(function(t){1===t.data.code&&(e.tableData=t.data.dat)})},handler_dataTableLock:function(e,t){var r=this,a=1===t?"你确定解冻该用户?":"你确定冻结该用户?";swal({title:a,type:"warning",showCancelButton:!0,reverseButtons:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.a.edit_systemUserHandlerLock({userId:e.id,lock:t}).then(function(e){1===e.data.code&&(r.data_table(),r.$message({duration:1500,message:"操作成功！"}))})},function(){})},handlerUserData_edit:function(e){var t=this;this.addUserForm.addUserIsShow=!0,this.get_allAreaAndStore();var r=this;r.$nextTick(function(){if(e.id){r.dialogTitle="编辑用户",r.employeeIdDisabled=!0;var a=e.roleIds.split(",").map(function(e){return parseInt(e)}),o=e.areaIds.split("-").map(function(e){return parseInt(e)});t.$refs.tree.setCheckedKeys(o),t.defaultCheckedKeys=o,t.addUserForm.id=e.id,t.addUserForm.employeeId=e.employeeId,t.addUserForm.realName=e.realName,t.addUserForm.phone=e.phone,t.addUserForm.remark=e.remark,t.addUserForm.roleIds=a}else r.dialogTitle="新增用户",r.employeeIdDisabled=!1,r.$refs.tree.setCheckedKeys([])})},handlerUserData_del:function(e){var t=this;swal({title:"你确定要删除该用户?",type:"warning",showCancelButton:!0,reverseButtons:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){s.a.data_systemUserDel({userId:e}).then(function(e){1===e.data.code&&(t.data_table(),t.$message({duration:1500,message:"操作成功！"}))})},function(){})},save_dataTable:function(){var e=this;new o.a(function(t){e.addUserForm.treeDialog.checkedValue=e.$refs.tree.getCheckedNodes(),t()}).then(function(t){e.$refs.addUserForm.validate(function(t){if(!t)return!1;var r=e.$refs.tree.getCheckedKeys().sort(function(e,t){return e-t});s.a.data_systemUserSave({id:e.addUserForm.id,employeeId:e.addUserForm.employeeId,realName:e.addUserForm.realName,phone:e.addUserForm.phone,remark:e.addUserForm.remark,areaIds:r.join(","),roleIds:e.addUserForm.roleIds.join(",")}).then(function(t){e.$store.dispatch("fetch_allAreaAndStore"),1===t.data.code&&(e.data_table(),e.handleClose(),e.$message({duration:1500,message:"操作成功！"}))})})})},recursiveArea:function(e,t){var r=[];e.forEach(function(e){t.forEach(function(e){var t="";t+=e.id+"-",e.children&&e.children.length>0?e.children.forEach(function(e){t+=e.id+"-"}):r.push(t)})})},data_systemUserRoleList:function(){var e=this;s.a.data_systemUserRoleList().then(function(t){1===t.data.code&&(e.roleList=t.data.dat)})},get_allAreaAndStore:function(){var e=this;return new o.a(function(t){s.a.fetch_allAreaAndStore().then(function(r){1===r.data.code&&(e.addUserForm.treeDialog.routerAuth=r.data.dat,t())})})}},watch:{"this.addUserForm.addUserIsShow":function(){this.addUserForm.addUserIsShow&&this.get_allAreaAndStore()}}}},2040:function(e,t,r){t=e.exports=r(1829)(!0),t.push([e.i,".view-user .user-group{margin-bottom:20px}.view-user .area-box .el-tree{height:200px;overflow-y:auto;border:1px solid #ddd;border-radius:4px}","",{version:3,sources:["D:/www.github.com/project/product/src/components/manage-system/childrens/user.vue"],names:[],mappings:"AACA,uBACE,kBAAoB,CACrB,AACD,8BACE,aAAc,AACd,gBAAiB,AACjB,sBAAuB,AACvB,iBAAmB,CACpB",file:"user.vue",sourcesContent:["\n.view-user .user-group {\n  margin-bottom: 20px;\n}\n.view-user .area-box .el-tree {\n  height: 200px;\n  overflow-y: auto;\n  border: 1px #ddd solid;\n  border-radius: 4px;\n}\n"],sourceRoot:""}])},2078:function(e,t,r){var a=r(2040);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r(1830)("01855cd2",a,!0)},2128:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"view-user"},[r("div",{staticClass:"user-group"},[r("el-button",{attrs:{disabled:!e.btn_auth("b_yh_xzyh")},on:{click:e.handlerUserData_edit}},[e._v("新增用户")])],1),e._v(" "),r("div",{staticClass:"system-user-table"},[r("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:e.tabHeight,"max-height":e.tabHeight,border:"","tooltip-effect":"dark"}},[r("el-table-column",{attrs:{prop:"employeeId",align:"center",label:"员工号"}}),e._v(" "),r("el-table-column",{attrs:{prop:"realName",align:"center",label:"姓名"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phone",align:"center",label:"联系方式","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"roleNames",align:"center",label:"角色","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{prop:"remark",align:"center",label:"备注","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handlerUserData_edit(t.row)}}},[e._v("编辑")]),e._v(" "),1===t.row.isEnabled?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handler_dataTableLock(t.row,1)}}},[e._v("冻结")]):e._e(),e._v(" "),0===t.row.isEnabled?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handler_dataTableLock(t.row,0)}}},[e._v("解冻")]):e._e(),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.handlerUserData_del(t.row.id)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),r("el-dialog",{attrs:{title:e.dialogTitle,visible:e.addUserForm.addUserIsShow,size:"small","before-close":e.handleClose},on:{"update:visible":function(t){e.addUserForm.addUserIsShow=t}}},[r("el-form",{ref:"addUserForm",attrs:{model:e.addUserForm,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"工号: ",prop:"employeeId"}},[r("el-input",{attrs:{disabled:e.employeeIdDisabled},model:{value:e.addUserForm.employeeId,callback:function(t){e.addUserForm.employeeId=t},expression:"addUserForm.employeeId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"姓名: ",prop:"realName"}},[r("el-input",{model:{value:e.addUserForm.realName,callback:function(t){e.addUserForm.realName=t},expression:"addUserForm.realName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号: ",prop:"phone"}},[r("el-input",{model:{value:e.addUserForm.phone,callback:function(t){e.addUserForm.phone=t},expression:"addUserForm.phone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"备注",prop:"remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.addUserForm.remark,callback:function(t){e.addUserForm.remark=t},expression:"addUserForm.remark"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"角色: ",prop:"roleIds"}},[r("el-checkbox-group",{model:{value:e.addUserForm.roleIds,callback:function(t){e.addUserForm.roleIds=t},expression:"addUserForm.roleIds"}},e._l(e.roleList,function(t,a){return r("el-checkbox",{key:a,attrs:{label:t.val,name:"roleList"}},[e._v(e._s(t.label))])}))],1),e._v(" "),r("el-form-item",{staticClass:"area-box",attrs:{label:"选择区域: ",prop:"treeDialog.checkedValue"}},[r("el-tree",{ref:"tree",attrs:{data:this.treeCountry,"show-checkbox":"","node-key":"id","default-expanded-keys":e.defaultCheckedData,props:e.defaultProps}})],1),e._v(" "),r("el-form-item",{staticStyle:{margin:"0","text-align":"right"}},[r("el-button",{on:{click:e.handleClose}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.save_dataTable}},[e._v("确定")])],1)],1)],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=19.76dc7adeb717aca2894e.js.map